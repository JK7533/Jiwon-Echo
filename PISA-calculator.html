<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;PISA Mitral Regurgitation Calculator&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>body { font-family: Arial, sans-serif; margin: 2em; background: #f7fafd; max-width: 600px;}</p>
<p class="p1"><span class="Apple-converted-space">    </span>h2 { color: #024; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>label { font-weight: bold; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>input { margin: 0.3em 0 1em 0.5em; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.result { font-weight: bold; font-size: 1.1em; margin: 1em 0; color: #155; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>table { border-collapse: collapse; margin-top: 1.5em;}</p>
<p class="p1"><span class="Apple-converted-space">    </span>th, td { border: 1px solid #bbb; padding: 6px 14px; text-align: center; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>th { background: #eef; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;h2&gt;PISA Mitral Regurgitation Calculator&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;form id="pisaForm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;label&gt;Radial distance r (cm):&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;input type="number" id="r" step="0.01" value="1.0"&gt;&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;label&gt;Aliasing velocity Vr (cm/s):&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;input type="number" id="Vr" step="0.1" value="40"&gt;&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;label&gt;Peak MR velocity Vmax (m/s):&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;input type="number" id="Vmax" step="0.01" value="5.0"&gt;&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;label&gt;MR VTI (cm):&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;input type="number" id="vti" step="0.1" value="120"&gt;&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;button type="button" onclick="calcPISA()"&gt;Calculate&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/form&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="result" id="pisaResult"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;table&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;th&gt;Severity&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;th&gt;ERO (mm²)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;th&gt;RVol (mL/beat)&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;tr&gt;&lt;td&gt;Mild&lt;/td&gt;&lt;td&gt;&amp;lt;20&lt;/td&gt;&lt;td&gt;&amp;lt;30&lt;/td&gt;&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;tr&gt;&lt;td&gt;Mild-Moderate&lt;/td&gt;&lt;td&gt;20–30&lt;/td&gt;&lt;td&gt;30–45&lt;/td&gt;&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;tr&gt;&lt;td&gt;Moderate-Severe&lt;/td&gt;&lt;td&gt;30–40&lt;/td&gt;&lt;td&gt;45–60&lt;/td&gt;&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;tr&gt;&lt;td&gt;Severe&lt;/td&gt;&lt;td&gt;&amp;ge;40&lt;/td&gt;&lt;td&gt;&amp;ge;60&lt;/td&gt;&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/table&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">function calcPISA() {</p>
<p class="p1"><span class="Apple-converted-space">  </span>// Get values and ensure all are positive numbers</p>
<p class="p1"><span class="Apple-converted-space">  </span>let r = Math.abs(parseFloat(document.getElementById('r').value));</p>
<p class="p1"><span class="Apple-converted-space">  </span>let Vr = Math.abs(parseFloat(document.getElementById('Vr').value));</p>
<p class="p1"><span class="Apple-converted-space">  </span>let Vmax = Math.abs(parseFloat(document.getElementById('Vmax').value));</p>
<p class="p1"><span class="Apple-converted-space">  </span>let vti = Math.abs(parseFloat(document.getElementById('vti').value));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>if (!r || !Vr || !Vmax || !vti) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.getElementById('pisaResult').innerHTML = "Please enter all values.";</p>
<p class="p1"><span class="Apple-converted-space">    </span>return;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>// VFR: 2 x π x r² x Vr (r in cm, Vr in cm/s, output in mL/s)</p>
<p class="p1"><span class="Apple-converted-space">  </span>let VFR = 2 * Math.PI * r * r * Vr; // (cm^2 * cm/s = cm^3/s = mL/s)</p>
<p class="p1"><span class="Apple-converted-space">  </span>// ERO: VFR / Vmax (Vmax in m/s, so convert to cm/s)</p>
<p class="p1"><span class="Apple-converted-space">  </span>let ERO = VFR / (Vmax * 100) * 100; // in mm² (1 cm² = 100 mm²)</p>
<p class="p1"><span class="Apple-converted-space">  </span>// RVol: ERO (in mm²) * VTI (in cm) (convert mm² to cm²)</p>
<p class="p1"><span class="Apple-converted-space">  </span>let RVol = (ERO / 100) * vti; // in mL/beat</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Interpretation</p>
<p class="p1"><span class="Apple-converted-space">  </span>let sev = '';</p>
<p class="p1"><span class="Apple-converted-space">  </span>if (ERO &lt; 20 &amp;&amp; RVol &lt; 30) sev = 'Mild';</p>
<p class="p1"><span class="Apple-converted-space">  </span>else if (ERO &lt; 30 &amp;&amp; RVol &lt; 45) sev = 'Mild-Moderate';</p>
<p class="p1"><span class="Apple-converted-space">  </span>else if (ERO &lt; 40 &amp;&amp; RVol &lt; 60) sev = 'Moderate-Severe';</p>
<p class="p1"><span class="Apple-converted-space">  </span>else sev = 'Severe';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>document.getElementById('pisaResult').innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;b&gt;Results:&lt;/b&gt;&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>Volume Flow Rate (VFR): &lt;b&gt;${VFR.toFixed(1)}&lt;/b&gt; mL/s&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>Effective Regurgitant Orifice (ERO): &lt;b&gt;${ERO.toFixed(1)}&lt;/b&gt; mm²&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>Regurgitant Volume (RVol): &lt;b&gt;${RVol.toFixed(1)}&lt;/b&gt; mL/beat&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;span style="color: #960; font-weight: bold;"&gt;Severity: ${sev}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>`;</p>
<p class="p1">}</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
